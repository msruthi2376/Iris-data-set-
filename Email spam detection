# Import libraries
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from wordcloud import WordCloud

# Load dataset
# (Place your dataset file in the same folder or provide full path)
df = pd.read_csv("spam.csv", encoding='latin-1')

# Display first few rows
print("First 5 rows of the dataset:")
print(df.head())

# Show dataset info
print("\nDataset Information:")
print(df.info())

# Remove unnecessary columns (some spam datasets have extra columns)
df = df.rename(columns={'v1': 'label', 'v2': 'message'})
df = df[['label', 'message']]

# Show missing values
print("\nMissing values:")
print(df.isnull().sum())

# Show data balance
print("\nNumber of spam and ham (non-spam) messages:")
print(df['label'].value_counts())

# Visualize class distribution
sns.countplot(x='label', data=df, palette='Set2')
plt.title("Distribution of Spam and Ham Emails")
plt.show()

# Calculate message lengths
df['message_length'] = df['message'].apply(len)

# Summary statistics
print("\nMessage length statistics:")
print(df.groupby('label')['message_length'].describe())

# Visualize message length distribution
plt.figure(figsize=(10,6))
sns.histplot(df[df['label']=='ham']['message_length'], color='green', label='Ham', kde=True)
sns.histplot(df[df['label']=='spam']['message_length'], color='red', label='Spam', kde=True)
plt.legend()
plt.title("Message Length Distribution (Ham vs Spam)")
plt.xlabel("Message Length")
plt.ylabel("Frequency")
plt.show()

# Generate WordCloud for spam messages
spam_words = " ".join(df[df['label']=='spam']['message'])
spam_wc = WordCloud(width=800, height=400, background_color='black', colormap='Reds').generate(spam_words)

plt.figure(figsize=(10,6))
plt.imshow(spam_wc, interpolation='bilinear')
plt.axis('off')
plt.title("WordCloud for Spam Messages", fontsize=16)
plt.show()

# Generate WordCloud for ham messages
ham_words = " ".join(df[df['label']=='ham']['message'])
ham_wc = WordCloud(width=800, height=400, background_color='white', colormap='Greens').generate(ham_words)

plt.figure(figsize=(10,6))
plt.imshow(ham_wc, interpolation='bilinear')
plt.axis('off')
plt.title("WordCloud for Ham Messages", fontsize=16)
plt.show()
